<nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0" x-user-data>
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" ng-href="/">{{ user.conf.title }}, {{ user.info.branch_name }}</a>
    </div>
    <ul class="nav navbar-top-links navbar-right">
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-envelope fa-fw"></i>  <i class="fa fa-caret-down"></i>
            </a>
            <ul class="dropdown-menu dropdown-messages">
                <li>
                    <a href="#">
                        <div>
                            <strong>John Smith</strong>
                            <span class="pull-right text-muted">
                                <em>Yesterday</em>
                            </span>
                        </div>
                        <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque eleifend...</div>
                    </a>
                </li>
                <li class="divider"></li>
                <li>
                    <a href="#">
                        <div>
                            <strong>John Smith</strong>
                            <span class="pull-right text-muted">
                                <em>Yesterday</em>
                            </span>
                        </div>
                        <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque eleifend...</div>
                    </a>
                </li>
                <li class="divider"></li>
                <li>
                    <a class="text-center" href="#">
                        <strong>Read All Messages</strong>
                        <i class="fa fa-angle-right"></i>
                    </a>
                </li>
            </ul>
        </li>
        <li class="dropdown">
            <a class="dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-user fa-fw"></i>  <i class="fa fa-caret-down"></i>
            </a>
            <ul class="dropdown-menu dropdown-user">
                <li>
                    <a ng-href="/"><i class="fa fa-user fa-fw"></i>{{ 'HELLO' | translate }}, <span ng-bind="user.info.name"></span></a>
                </li>
                <li class="divider"></li>
                <li>
                    <a ng-href="/#/logout"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                </li>
            </ul>
        </li>
    </ul>

    <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
            <ul class="nav" id="side-menu">
                <li>
                    <a href="/#/dashboard">
                        <i class="fa fa-dashboard fa-fw"></i> {{ 'DASHBOARD' | translate }}
                    </a>
                </li>
                <li>
                    <a href="javascript:;" x-second-menu data-toggle="collapse" data-target="#files-menu">
                        <i class="fa fa-archive fa-fw"></i> {{ 'FILES' | translate }} <span class="fa arrow"></span>
                    </a>
                    <ul class="nav nav-second-level">
                        <li ng-if="user.permissions.isAllowed('CUSTOMERS', 'GET_LIST')">
                            <a href="/#/customers"><i class="fa fa-suitcase fa-fw"></i> {{ 'CUSTOMERS' | translate }}</a>
                        </li>
                        <li ng-if="user.permissions.isAllowed('CATEGORIES', 'GET')">
                            <a href="/#/categories"><i class="fa fa-filter fa-fw"></i> {{ 'CATEGORIES' | translate }}</a>
                        </li>
                        <li ng-if="user.permissions.isAllowed('PRODUCTS', 'GET')">
                            <a href="/#/products"><i class="fa fa-barcode fa-fw"></i> {{ 'PRODUCTS' | translate }}</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-wrench fa-fw"></i> {{ 'SETTINGS' | translate }}<span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level">
                        <li ng-if="user.permissions.isAllowed('USERS_OWN', 'GET')">
                            <a href="/#/profile-settings">
                                <i class="fa fa-user fa-fw"></i> {{ 'USER_PROFILE' | translate }}
                            </a>
                        </li>
                        <li ng-if="user.permissions.isAllowed('SETTINGS', 'GET')">
                            <a href="/#/settings">
                                <i class="fa fa-cogs fa-fw"></i> {{ 'SYSTEM_SETTINGS' | translate }}
                            </a>
                        </li>
                        <li ng-if="user.permissions.isAllowed('ROLES', 'GET_LIST')">
                            <a href="/#/roles">
                                <i class="fa fa-users fa-fw"></i> {{ 'USERS_ROLES' | translate }}
                            </a>
                        </li>
                        <li ng-if="user.permissions.isAllowed('USERS', 'GET_LIST')">
                            <a href="/#/users">
                                <i class="fa fa-male fa-fw"></i> {{ 'MANAGE' | translate }} {{ 'USERS' | translate }}
                            </a>
                        </li>
                        <li ng-if="user.permissions.isAllowed('BRANCHES', 'GET_LIST')">
                            <a href="/#/branches">
                                <i class="fa fa-sitemap fa-fw"></i> {{ 'MANAGE' | translate }} {{ 'BRANCHES' | translate }}
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script type="text/javascript">
    $(function() {

        $('#side-menu').metisMenu();

    });

    //Loads the correct sidebar on window load,
    //collapses the sidebar on window resize.
    // Sets the min-height of #page-wrapper to window size
    $(function() {
        $(window).bind("load resize", function() {
            topOffset = 50;
            width = (this.window.innerWidth > 0) ? this.window.innerWidth : this.screen.width;
            if (width < 768) {
                $('div.navbar-collapse').addClass('collapse');
                topOffset = 100; // 2-row-menu
            } else {
                $('div.navbar-collapse').removeClass('collapse');
            }

            height = ((this.window.innerHeight > 0) ? this.window.innerHeight : this.screen.height) - 1;
            height = height - topOffset;
            if (height < 1) height = 1;
            if (height > topOffset) {
                $("#page-wrapper").css("min-height", (height) + "px");
            }
        });

        var url = window.location;
        var element = $('ul.nav a').filter(function() {
            return this.href == url || url.href.indexOf(this.href) == 0;
        }).addClass('active').parent().parent().addClass('in').parent();
        if (element.is('li')) {
            element.addClass('active');
        }
    });
    
</script>